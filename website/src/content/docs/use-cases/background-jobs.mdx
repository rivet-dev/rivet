# Background Jobs

## Challenges of Building Background Job Systems

Common tools: Celery, Bull, Sidekiq, AWS SQS, RabbitMQ, Redis queues, cron jobs

Main pain points:
- Managing separate job queue infrastructure and worker processes
- Tracking job state and results across distributed systems
- Handling job retries, failures, and dead letter queues
- Coordinating scheduled and recurring jobs with cron syntax
- Persisting job state and intermediate results during long-running tasks

## How Rivet Solves This

Rivet actors provide built-in job scheduling and execution with automatic state persistence and no external queue infrastructure.

**Self-Contained Job Execution**: Each actor can schedule and execute background tasks with full access to its persistent state.

```typescript
const jobProcessor = actor({
  state: {
    jobs: {} as Record<string, {
      status: "pending" | "running" | "completed" | "failed",
      result?: any,
      error?: string
    }>,
    queue: [] as string[]
  },

  actions: {
    enqueueJob: (c, jobId: string, delay?: number) => {
      c.state.jobs[jobId] = { status: "pending" };
      c.state.queue.push(jobId);

      if (delay) {
        c.schedule.after(delay, "processJob", jobId);
      } else {
        c.schedule.immediate("processJob", jobId);
      }

      return jobId;
    },

    processJob: async (c, jobId: string) => {
      c.state.jobs[jobId].status = "running";
      c.broadcast("jobUpdate", { jobId, status: "running" });

      try {
        const result = await performWork(jobId);
        c.state.jobs[jobId] = { status: "completed", result };
        c.broadcast("jobUpdate", { jobId, status: "completed", result });
      } catch (error) {
        c.state.jobs[jobId] = {
          status: "failed",
          error: error.message
        };
        c.broadcast("jobUpdate", { jobId, status: "failed", error: error.message });
      }
    }
  }
});
```

**Built-in Scheduling**: Schedule delayed and recurring jobs using [scheduled actions](/docs/actors/schedule) without cron or external schedulers.

**Durable State**: Job state persists automatically, surviving restarts and failures. See [state management](/docs/actors/state).

**Realtime Progress**: Stream job progress and results to clients using [events](/docs/actors/events).

**No Queue Infrastructure**: Execute jobs directly within actors without Redis, RabbitMQ, or other message queues.

## Full Example Projects

<CardGroup>
<Card href="https://github.com/rivet-dev/rivet/tree/main/examples/background-jobs" title="Background Jobs Example" />
</CardGroup>
