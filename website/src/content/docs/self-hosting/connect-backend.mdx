# Connecting Your Backend to Rivet Engine

Unless exlpicitly configured, Rivet will default to running on the local file system without using the Rivet Engine. This is perfect for local development and testing.

When ready to scale the backend, RivetKit can connect to a Rivet Engine instance using the `RIVET_ENDPOINT` environment variable.

<Tip>
	The engine is not required at any point during development. It is only required to scale RivetKit to multiple nodes.
</Tip>

## Connecting Runners

To connect a runner to your Rivet Engine, set the `RIVET_ENDPOINT` environment variable:

```bash
RIVET_ENDPOINT=http://your-engine-host:6420 npm run dev
```

Once connected:
- The runner appears in the Runners tab of the dashboard
- Your actor names show up in the sidebar
- The engine begins routing traffic to your runner

## Environment Variables

### `RIVET_ENDPOINT`
The endpoint of your Rivet Engine instance.

Supports URL auth syntax for namespace and token:
- `https://namespace:token@engine.your-domain.com`
- `https://namespace@engine.your-domain.com`

```bash
# Local development
RIVET_ENDPOINT=http://localhost:6420

# Production
RIVET_ENDPOINT=https://engine.your-domain.com

# With embedded credentials
RIVET_ENDPOINT=https://production:secret-token@engine.your-domain.com
```

### `RIVET_TOKEN`
Authentication token for connecting to the engine. Can also be embedded in the `RIVET_ENDPOINT` URL.

```bash
RIVET_TOKEN=your-auth-token
```

### `RIVET_NAMESPACE`
The namespace to run actors in. Useful for multi-tenant deployments. Can also be embedded in the `RIVET_ENDPOINT` URL.

```bash
RIVET_NAMESPACE=production
```

### `RIVET_RUNNER`
A name for the runner to allow filtering which nodes to run actors on.

```bash
RIVET_RUNNER=worker-01
```

### `RIVET_RUNNER_KEY`
A unique key for the runner. If another runner connects with the same key, the previous one is disconnected. This is useful for handling zombie runners that weren't shut down gracefully.

```bash
RIVET_RUNNER_KEY=unique-runner-key-123
```

<Tip>
  Generate a unique runner key using: `uuidgen` or `openssl rand -hex 16`
</Tip>

### `RIVET_PUBLIC_ENDPOINT`
The endpoint that clients should use to connect. Required in production for serverless deployments.

Supports URL auth syntax for namespace and token:
- `https://namespace:token@your-app.example.com/api/rivet`
- `https://namespace@your-app.example.com/api/rivet`

```bash
# Tell clients to connect via your app's public URL
RIVET_PUBLIC_ENDPOINT=https://your-app.example.com/api/rivet

# With embedded credentials for client authentication
RIVET_PUBLIC_ENDPOINT=https://production:client-token@your-app.example.com/api/rivet
```

### `RIVET_PUBLIC_TOKEN`
Token that clients should use when connecting. Can also be embedded in the `RIVET_PUBLIC_ENDPOINT` URL.

```bash
RIVET_PUBLIC_TOKEN=client-facing-token
```

## Connection Examples

### Testing Setup

You do not need the engine for local development, but it can be helpful for testing your production-readiness: 

```bash
# Start the engine
docker run -p 6420:6420 rivetkit/engine

# In another terminal, start your runner
RIVET_ENDPOINT=http://localhost:6420 npm run dev
```

### Production Setup

```bash
# Assume the engine is running at 1.2.3.4

# On runner nodes
RIVET_ENDPOINT=http://1.2.3.4 \
RIVET_NAMESPACE=production \
RIVET_RUNNER=worker-$(hostname) \
RIVET_RUNNER_KEY=$(cat /etc/machine-id) \
npm run start
```

