# Connecting Your Backend to Rivet Engine

Unless exlpicitly configured, Rivet will default to running on the local file system without using the Rivet Engine. This is perfect for local development and testing.

When ready to scale the backend, RivetKit can connect to a Rivet Engine instance using the `RIVET_ENGINE` environment variable.

<Tip>
	The engine is not required at any point during development. It is only required to scale RivetKit to multiple nodes.
</Tip>

## Connecting Runners

To connect a runner to your Rivet Engine, set the `RIVET_ENGINE` environment variable:

```bash
RIVET_ENGINE=http://your-engine-host:6420 npm run dev
```

Once connected:
- The runner appears in the Runners tab of the dashboard
- Your actor names show up in the sidebar
- The engine begins routing traffic to your runner

## Environment Variables

RivetKit supports two formats for configuration:

1. **Unified Endpoint Format** (Recommended): Embed namespace and token in the endpoint URL
2. **Separate Variables**: Use individual environment variables for each config

### Unified Endpoint Format (Recommended)

The unified format allows you to specify the endpoint, namespace, and token in a single URL using HTTP Basic Auth syntax:

```bash
# Format: https://namespace:token@endpoint
RIVET_ENDPOINT=https://my-namespace:pub_abc123@api.rivet.dev
```

This format is more concise and reduces configuration complexity. The namespace and token are automatically extracted from the URL.

### Separate Variables

You can also use separate environment variables:

```bash
RIVET_ENDPOINT=https://api.rivet.dev
RIVET_NAMESPACE=my-namespace
RIVET_TOKEN=pub_abc123
```

<Note>
Both formats are supported. Choose the one that works best for your deployment workflow.
</Note>

### Configuration Details

### `RIVET_ENDPOINT` or `RIVET_ENGINE`
The endpoint of your Rivet Engine instance. Can include namespace and token in unified format.

```bash
# Unified format (recommended) - only supported by RIVET_ENDPOINT
RIVET_ENDPOINT=https://my-namespace:pub_abc123@api.rivet.dev

# Or separate endpoint only
RIVET_ENDPOINT=https://api.rivet.dev

# Legacy alias RIVET_ENGINE (endpoint only, no unified format)
RIVET_ENGINE=http://localhost:6420
```

<Note>
`RIVET_ENGINE` is a legacy alias for `RIVET_ENDPOINT` that only supports endpoint-only configuration. Use `RIVET_ENDPOINT` for the unified format with embedded credentials.
</Note>

### `RIVET_TOKEN`
Authentication token for accessing the Rivet Engine (when not using unified endpoint format).

```bash
# Client/publishable token (safe for frontend)
RIVET_TOKEN=pub_abc123

# Runner/secret token (backend only)
RIVET_TOKEN=sec_xyz789
```

### `RIVET_NAMESPACE`
The namespace to run actors in (when not using unified endpoint format). Useful for multi-tenant deployments.

```bash
RIVET_NAMESPACE=production
```

### `RIVET_RUNNER`
A name for the runner to allow filtering which nodes to run actors on.

```bash
RIVET_RUNNER=worker-01
```

### `RIVET_RUNNER_KEY`
A unique key for the runner. If another runner connects with the same key, the previous one is disconnected. This is useful for handling zombie runners that weren't shut down gracefully.

```bash
RIVET_RUNNER_KEY=unique-runner-key-123
```

<Tip>
  Generate a unique runner key using: `uuidgen` or `openssl rand -hex 16`
</Tip>

## Connection Examples

### Local Development (No Engine)

You do not need the engine for local development:

```bash
npm run dev
```

### Local Development (With Engine)

For testing production-readiness:

```bash
# Start the engine
docker run -p 6420:6420 rivetkit/engine

# In another terminal, start your runner with unified endpoint
RIVET_ENDPOINT=http://default:your-token@localhost:6420 npm run dev

# Or with separate variables
RIVET_ENDPOINT=http://localhost:6420 \
RIVET_NAMESPACE=default \
RIVET_TOKEN=your-token \
npm run dev
```

### Production Setup

```bash
# With unified endpoint (recommended)
RIVET_ENDPOINT=https://my-namespace:pub_abc123@api.rivet.dev \
RIVET_RUNNER=worker-$(hostname) \
RIVET_RUNNER_KEY=$(cat /etc/machine-id) \
npm run start

# Or with separate variables
RIVET_ENDPOINT=https://api.rivet.dev \
RIVET_NAMESPACE=my-namespace \
RIVET_TOKEN=pub_abc123 \
RIVET_RUNNER=worker-$(hostname) \
RIVET_RUNNER_KEY=$(cat /etc/machine-id) \
npm run start
```

